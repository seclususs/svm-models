{% extends "base.html" %}

{% block title %}Klasifikasi Massal - Klasifikasi Cuaca{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8 text-center">
        <h1 class="display-4 fw-bold">Klasifikasi Massal</h1>
        <p class="lead text-muted mb-4">Unggah beberapa gambar untuk mendapatkan hasil Klasifikasi untuk setiap gambar.</p>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert alert-danger alert-dismissible fade show mt-4" role="alert">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-exclamation-triangle-fill me-2" viewBox="0 0 16 16"><path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/></svg>
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div id="upload-card" class="card mt-4 shadow-lg border-0">
            <div class="card-body p-4 p-md-5">
                <form id="prediction-form" action="{{ url_for('batch.upload_batch') }}" method="post" enctype="multipart/form-data">
                    <div class="file-drop-area">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-images mb-3 text-primary" viewBox="0 0 16 16">
                          <path d="M4.502 9a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"/>
                          <path d="M14.002 13a2 2 0 0 1-2 2h-10a2 2 0 0 1-2-2V5A2 2 0 0 1 2 3a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-1.998 2zM14 2H4a1 1 0 0 0-1 1h9.002a2 2 0 0 1 2 2v7A1 1 0 0 0 15 11V3a1 1 0 0 0-1-1zM2.002 4a1 1 0 0 0-1 1v8l2.646-2.354a.5.5 0 0 1 .63-.062l2.66 1.773 3.71-3.71a.5.5 0 0 1 .577-.094l1.777 1.947V5a1 1 0 0 0-1-1h-10z"/>
                        </svg>
                        <p class="file-drop-text"><strong>Seret & Lepas</strong> beberapa gambar di sini, atau klik untuk memilih.</p>
                        <input class="file-input" type="file" id="files" name="files" accept="image/png, image/jpeg, image/jpg" required multiple>
                        <div id="file-name-preview" class="form-text mt-2"></div>
                    </div>
                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-primary btn-lg" id="submit-btn" disabled>
                            Klasifikasi Gambar
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <div id="loading-spinner" class="text-center mt-5" style="display: none;">
            <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="lead mt-3">Mengarahkan ke halaman hasil...</p>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/batch-upload.js') }}"></script>
{% endblock %}
